{% extends 'base.html' %}
{% block content %}
<div class="mb-6">
  <h1 class="text-3xl font-bold text-navy">FoobaKickz</h1>
  <p class="mt-1 text-gray-600">
    {% if user.is_authenticated %}
      Welcome, {{ user.username }}
    {% else %}
      Welcome, guest
    {% endif %}
  </p>
  <p class="text-sm text-gray-500">Last login: {{ last_login }}</p>

  <div class="mt-4">
    {% if user.is_authenticated %}
      <a href="{% url 'main:create_product' %}" 
         class="bg-tealEgg hover:bg-navy text-white font-semibold px-5 py-2 rounded-lg shadow-md transition">
         + Add Product
      </a>
    {% else %}
      <a href="{% url 'main:login' %}" class="inline-block px-4 py-2 bg-gray-200 text-gray-700 rounded">Login to add</a>
    {% endif %}
  </div>
</div>

<!-- Filter Buttons -->
<div class="mb-6 flex gap-3">
  <a href="?filter=all" class="px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded text-gray-700">All Products</a>
  <a href="?filter=my" class="px-4 py-2 {% if user.is_authenticated %}bg-tealEgg hover:bg-navy text-white{% else %}bg-gray-100 text-gray-700{% endif %} rounded">My Products</a>
</div>

{% if not product_list %}
  <div class="text-center p-10 bg-white rounded shadow">
    <p class="text-gray-600">Belum ada produk.</p>
  </div>
{% else %}
  <!-- GRID PRODUCT CARD -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
    {% for p in product_list %}
      <article class="bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition transform hover:-translate-y-1">
        
        <!-- Thumbnail -->
        {% if p.thumbnail %}
          <img src="{{ p.thumbnail }}" alt="{{ p.name }}" class="w-full h-48 object-cover">
        {% else %}
          <div class="w-full h-48 bg-gray-200 flex items-center justify-center text-gray-500">
            No Image
          </div>
        {% endif %}

        <!-- Content -->
        <div class="p-5">
          <h3 class="font-bold text-xl text-navy mb-2">{{ p.name }}</h3>
          <p class="text-lg font-semibold text-tealEgg">Rp {{ p.price }}</p>
          <p class="text-sm text-gray-600">{{ p.category }}</p>

          <p class="mt-3 text-sm text-gray-700">{{ p.description|truncatewords:20 }}</p>
          <p class="text-xs text-gray-400 mt-2">Stock: {{ p.stock }}</p>
          <p class="text-xs text-gray-400">Author: {% if p.user %}{{ p.user.username }}{% else %}Anonymous{% endif %}</p>

          <!-- Buttons -->
          <div class="mt-4 flex gap-3">
            <a href="{% url 'main:show_product' p.id %}" class="bg-tealEgg hover:bg-navy text-white px-4 py-2 rounded-lg text-sm shadow">Detail</a>
            {% if user.is_authenticated and p.user == user %}
              <a href="{% url 'main:edit_product' p.id %}" class="px-3 py-2 bg-yellow-400 text-gray-800 rounded text-sm">Edit</a>
              <a href="{% url 'main:delete_product' p.id %}" class="px-3 py-2 bg-red-500 text-white rounded text-sm">Delete</a>
            {% endif %}
          </div>
        </div>
      </article>
    {% endfor %}
  </div>
{% endif %}
{% endblock %}
